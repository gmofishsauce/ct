# ct

# UPDATE - don't take the time to follow these instructions. Constact me.

## Overview

The application runs in a web page and makes requests to a localhost-only server.

## Status

Prototype - call it "alpha" status if you like. The design and implementation are
horrible. The code was pulled together from a bunch of examples, some from the docs
for various libraries, some generated by AIs. Also, it's my first significant
Javascript program. It is pure HTML, handwritten CSS, and Javascript, using no framework.

## Building and Running

The prototype has three major components, each written in a different programming language.
To build and run the prototype, you need the correct tooling for each.

### Stockfish chess engine (the "engine")

Stockfish is written in C++. I've built it on Intel Mac using clang. Stockfish is designed
for portability and "should" compile cleanly on every major architecture using the leading
C++ compiler for that architecture. I'm uncertain about MSVC and Windows.

### Local server (the "server")

The server is written in Golang. It was vibe-coded by ChatGPT5. You'll need the Go compiler
v1.23 or later for your platform.

### Front end (the "client")

You should install npm, npx and vite. See https://threejs.org/manual/#en/installation and
scroll down to **Option 1**. Follow the instructions. The server does not use node.js.

### Specifics

1. Open a command line and change to `sf/Stockfish-master/src` in the repo. Type `make`.
This will give examples of the required platform-specific command line. There are many
supported architectures, mostly covering performance-oriented variations on the x86-64
architecture (e.g. `ARCH=x86-64-sse41-popcnt` for x86-64 with SSE4.1 and the population
count instruction). **There's no need to optimize.** I recommend using `ARCH=x86-64` or
`ARCH=apple-silicon` as appropriate, e.g. `make -j profile-build ARCH=apple-silicon`.  If you have difficulties building Stockfirst for
your platform, please let me know.

1. Move the generated binary up a couple of directories to `sf/` so the binary is
`<repo>/sf/stockfish`.

1. Change directories to the `srv/` top level directory in the repo. Enter this command
to run Stockfish: `../sf/stockfish`. It should respond with a line like this:
`Stockfish dev-20250819-4754edd1 by the Stockfish developers (see AUTHORS file)`

1. Type `uci<enter>`. Stockfish should respond with a list of option settings and end
with `uciok`. That's it for now; use ^D to shut it down.

1. Continuing in the `srv/` directory, `go build`. This should create the binary, `srv/srv`.

1. Run the binary: `./srv --allowed-origin http://localhost:5173`. It should respond:
`202X/MM/DD HH:MM:SS Starting server on :8080 (serveStatic=, allowedOrigin="http://localhost:5173", cmd="../sf/stockfish")`

1. Open a second command line window and cd to `<repo>/js`. Run: `npx vite`. You should
see something like `VITE v7.1.9  ready in 218 ms` and below that, some lines including
`âžœ  Local:   http://localhost:5173/`.

1. Open a web page and visit `http://localhost:5173`.

## Usage

You should see a page with a gray canvas and darker gray command and status bars at top and bottom.
The top bar should contain a text box populated with a string and there should be button labeled **Go**.
Since you left the server running, the bottom bar should contain the message `server status: running`. There should be a small chessboard
at upper left.

The string in the text box is a [**FEN**](https://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation). In particular, it matches the chessboard: it's the starting position. Click **Go**.

You should see some hexagonal cylinders "grow" into position on the canvas. I call these hexcyls. They display the engine's analysis of the best moves from the starting position, which is represented by the center. You can use the mouse to reorient the terrain display. Please be patient with user interactions; server communication is intentionally very slow to simplify debugging. It can easily be made faster and will be in the future.

Now click on a "live" hexcyl (not the center one). The chessboard and FEN should display the move. The new "center" hexcyl's unoccupied neighbors rise to display the best moves of this new position.

Make a move on the chessboard that is not one of the moves recommended by the engine (for example, try moving the king, or an edge pawn). Again, everything else should update. Do this a few times. Finally, click Go again. Clicking Go clears the canvas and restarts analysis with the FEN as the center hexcyl.

**Important notes:** when you're done with ChessTerrain, be sure and kill the server,
which should kill Stockfish. If you don't, it will continue analyzing, which uses significant
CPU and will quickly drain the battery on your laptop.

I'm curious for feedback on the display.

